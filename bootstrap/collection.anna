use(parser);

macro __collection__(node)
{
    if(node.count > 0 and node[0].isCallTo("__mapping__"))
    {
	node.function = Dummy(node, HashMap);
	node.each(ch)
	{
	    if(!ch.isCallTo("__mapping__"))
	    {
		ch.error("Not a key/value pair");
		return NullLiteral(node);
	    }
	    (ch as Call).function = Dummy(ch, Pair);
	}
    } else
    {
	node.function = Dummy(node, List);
    }
    return node;
}

